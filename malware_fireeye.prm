# LCE PRM LIBRARY
# Copyright 2004-2011 Tenable Network Security
# This library may only be used with the LCE server and may not
# be used with other products or open source projects
#
# NAME:
# Fireeye Alerts
#
# DESCRIPTION:
#
# These signatures look for a variety of events occuring in the
# FireEye software. They can be used by an LCE server to process
# events from hardware running the Fireeye software, must be in CSV format
# to work.
#
# LAST UPDATE: $Date$

id=5658
name=FireEye has reported a binary analysis alert.
match=fenotify-
match=le
match=alert
match=lert
match=ar
match=binary-analysis
regex=alert\: ([a-zA-Z0-9._-]+).*src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),spt=([0-9]+).*,dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),dpt=([0-9]+)
log=type:virus event:FireEye-Binary_Analysis_Alert sensor:$1 srcip:$2 srcport:$3 dstip:$4 dstport:$5

NEXT

id=5659
name=FireEye has reported a domain match alert.
match=fenotify-
match=le
match=alert
match=lert
match=domain-match
regex=alert\: ([a-zA-Z0-9._-]+).*src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),spt=([0-9]+).*,dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),dpt=([0-9]+)
log=type:virus event:FireEye-Domain_Match_Alert sensor:$1 srcip:$2 srcport:$3 dstip:$4 dstport:$5

NEXT

id=5660
name=FireEye has reported an infection match alert.
match=fenotify-
match=le
match=alert
match=lert
match=ion
match=infection-match
match=ect
regex=alert\: ([a-zA-Z0-9._-]+).*src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),spt=([0-9]+).*,dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),dpt=([0-9]+)
log=type:virus event:FireEye-Infection_Match_Alert sensor:$1 srcip:$2 srcport:$3 dstip:$4 dstport:$5


NEXT

id=5661
name=FireEye has reported a malware callback alert.
match=fenotify-
match=le
match=alert
match=lert
match=ack
match=ar
match=malware-callback
match=cal
regex=alert\: ([a-zA-Z0-9._-]+).*src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),spt=([0-9]+).*,dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),dpt=([0-9]+)
log=type:virus event:FireEye-Malware_Callback_Alert sensor:$1 srcip:$2 srcport:$3 dstip:$4 dstport:$5


NEXT

id=5662
name=FireEye has reported a web infection alert.
match=fenotify-
match=le
match=alert
match=lert
match=ion
match=web-infection
match=ect
regex=alert\: ([a-zA-Z0-9._-]+).*src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),spt=([0-9]+).*,dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),dpt=([0-9]+)
log=type:virus event:FireEye-Web_Infection_Alert sensor:$1 srcip:$2 srcport:$3 dstip:$4 dstport:$5


NEXT

id=5663
name=FireEye has reported a domain match alert.
match=fenotify-
match=le
match=alert
match=lert
match=domain-match
regex=alert\: ([a-zA-Z0-9._:-]+).*dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+).*,src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+),dpt=([0-9]+)
log=type:virus event:FireEye-Domain_Match_Alert sensor:$1 srcip:$3 dstip:$2 dstport:$4

NEXT

id=5664
name=FireEye has reported a malware-callback alert.
match=fenotify-
match=le
match=alert
match=lert
match=malware-callback
match=ll
match=mal
match=ba
regex=src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+).*dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+).*spt=([0-9]+).*dpt=([0-9]+)
log=type:virus event:FireEye-Malware_Callback srcip:$1 dstip:$2 srcport:$3 dstport:$4

NEXT

id=5665
name=FireEye has reported a malware-object alert.
match=fenotify-
match=le
match=alert
match=lert
match=malware-object
match=obj
match=mal
match=ect
regex=src=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+).*dst=([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)
log=type:virus event:FireEye-Malware_Object srcip:$1 dstip:$2
